<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\apt/server_add_relay_connection.apt at 2021-02-27

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>GraphQL Java Generator - Maven Plugin &#x2013; Managing the Relay Connection capability (in server mode)</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">com.graphql-java-generator:graphql-maven-plugin-project
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="projectVersion">Version: 1.12.3</span>
      </div>
      <div class="xright"><a href="project.html" title="Project on Github">Project on Github</a>        &#xA0;| <span id="publishDate">Last Published: 2021-02-27</span>
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Plugin Usage</h5>
    <ul>
     <li class="none"><a href="README.html" title="Introduction">Introduction</a></li>
     <li class="none"><a href="change_log.html" title="Change Log">Change Log</a></li>
     <li class="none"><a href="customscalars.html" title="Custom Scalars">Custom Scalars</a></li>
     <li class="none"><a href="customtemplates.html" title="Custom Code Templates">Custom Code Templates</a></li>
     <li class="none"><a href="faq_client_and_server.html" title="FAQ (for both client and server mode)">FAQ (for both client and server mode)</a></li>
    </ul>
       <h5>Client mode</h5>
    <ul>
     <li class="none"><a href="client_spring.html" title="Creating a first app (spring)">Creating a first app (spring)</a></li>
     <li class="none"><a href="client_non_spring.html" title="Creating a first app (non spring)">Creating a first app (non spring)</a></li>
     <li class="none"><a href="exec_graphql_requests.html" title="Execute GraphQL requests">Execute GraphQL requests</a></li>
     <li class="none"><a href="client_tutorial.html" title="Client Tutorial">Client Tutorial</a></li>
     <li class="none"><a href="client_subscription.html" title="Subscription">Subscription</a></li>
     <li class="none"><a href="introspection.html" title="Introspection">Introspection</a></li>
     <li class="none"><a href="client_add_relay_connection.html" title="Relay Connections">Relay Connections</a></li>
     <li class="none"><a href="runtimeclasses.html" title="Runtime Classes">Runtime Classes</a></li>
     <li class="none"><a href="client_oauth2.html" title="Access to an OAuth2 GraphQL server">Access to an OAuth2 GraphQL server</a></li>
     <li class="none"><a href="client_personalization.html" title="How to personalize the client app">How to personalize the client app</a></li>
     <li class="none"><a href="faq_client.html" title="FAQ (client mode)">FAQ (client mode)</a></li>
    </ul>
       <h5>Server mode</h5>
    <ul>
     <li class="none"><a href="server.html" title="Server usage">Server usage</a></li>
     <li class="none"><a href="server_tutorial.html" title="Server Tutorial">Server Tutorial</a></li>
     <li class="none"><a href="server_subscription.html" title="Subscription">Subscription</a></li>
     <li class="none"><strong>Relay Connections</strong></li>
     <li class="none"><a href="server_oauth2.html" title="Implement an OAuth2 GraphQL server">Implement an OAuth2 GraphQL server</a></li>
     <li class="none"><a href="schema_personalization.html" title="Howto personalize the generated code">Howto personalize the generated code</a></li>
    </ul>
       <h5>Project internal</h5>
    <ul>
     <li class="none"><a href="howto_build.html" title="How to build?">How to build?</a></li>
     <li class="none"><a href="howto_contribute.html" title="How to contribute?">How to contribute?</a></li>
     <li class="none"><a href="howto_pgp_key.html" title="How to create a PGP key?">How to create a PGP key?</a></li>
     <li class="none"><a href="howto_release.html" title="How to release?">How to release?</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="graphql-java-runtime/index.html" title="graphql-java-runtime">graphql-java-runtime</a></li>
     <li class="none"><a href="graphql-maven-plugin/index.html" title="graphql-maven-plugin">graphql-maven-plugin</a></li>
     <li class="none"><a href="graphql-java-client-dependencies/index.html" title="graphql-java-client-dependencies">graphql-java-client-dependencies</a></li>
     <li class="none"><a href="graphql-java-server-dependencies/index.html" title="graphql-java-server-dependencies">graphql-java-server-dependencies</a></li>
     <li class="none"><a href="graphql-maven-plugin-logic/index.html" title="graphql-maven-plugin-logic">graphql-maven-plugin-logic</a></li>
     <li class="none"><a href="graphql-maven-plugin-samples/index.html" title="graphql-maven-plugin-samples">graphql-maven-plugin-samples</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="https://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="https://maven.apache.org/images/logos/maven-feather.png"     />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="Managing_the_Relay_Connection_capability_.28in_server_mode.29"></a>Managing the Relay Connection capability (in server mode)</h2>
<ul>
<li><a href="#Managing_the_Relay_Connection_capability_.28in_server_mode.29">Managing the Relay Connection capability (in server mode)</a>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#What_does_the_plugin.2C_to_manage_the_Relay_Connection_capability">What does the plugin, to manage the Relay Connection capability</a></li>
<li><a href="#Important_note_about_the_GraphQL_schema_.28only_when_in_server_mode.29">Important note about the GraphQL schema (only when in server mode)</a></li>
<li><a href="#What_tasks_are_executed_by_the_plugin.3F">What tasks are executed by the plugin?</a></li></ul></li></ul><section>
<h3><a name="Introduction">Introduction</a></h3>
<p>The <i>addRelayConnections</i> parameter configures the plugin, so that it uses the <i>@RelayConnection</i> directive as a marker, to apply the relay connection capabilities, as defined in the Relay specification. For more information, you can check <a class="externalLink" href="https://relay.dev/docs/en/graphql-server-specification.html"> The Relay GraphQL server specification</a> or the <a class="externalLink" href="https://relay.dev/graphql/connections.htm">Relay connection specification</a>.</p>
<p><b>When the addRelayConnections parameter is set to true</b>, the plugin reads the GraphQL schema file(s), and enriches them it with the interfaces and types needed to respect the Relay Connection specification. The entry point for that is the <i>@RelayConnection</i> directive. It is specific to this plugin. It can be added to any field, that is, typically: queries, mutations, interface's fields and any object's field.</p>
<p>The <i>addRelayConnections</i> parameter may be used in these goals/tasks of the plugin:</p>
<ul>
<li><i>generateClientCode</i>: this allows to generate a schema, with its XxxConnection and XxxEdge classes, the Node interface, the PageInfo type... The you can use the generated GraphQL schema in any tool you want.</li>
<li><i>generateClientCode</i>: this allows to have a GraphQL client that is able to call a server with these XxxConnection and XxxEdge classes, Node interface, PageInfo type...</li>
<li><i>generateServerCode</i>: this allows to create a GraphQL server that manages these XxxConnection and XxxEdge classes, Node interface, PageInfo type...</li>
<li><i>graphql</i> This deprecated goal/task should be avoided. But if you use it, it can use the <i>addRelayConnections</i> parameter as the <i>generateClientCode</i> and <i>generateServerCode</i> tasks/goals.</li></ul></section><section>
<h3><a name="What_does_the_plugin.2C_to_manage_the_Relay_Connection_capability"></a><a name="What_does_the_plugin_to_manage_the_Relay_Connection_capability">What does the plugin, to manage the Relay Connection capability</a></h3>
<p>It must be declared in the given GraphQL schema file(s) like this:</p>
<div class="source">
<pre>directive @RelayConnection on FIELD_DEFINITION
</pre></div>
<p>Then the <i>@RelayConnection</i> directive may be added to every field that should be used through a Relay connection. That is: <b>the field's type, whether it's a list or not, is replaced by the relevant XxxConnection type</b>. </p>
<p>For instance the query: </p>
<div class="source">
<pre>query {
  ...  
  allHumans(criteria: String): [Human] @RelayConnection,
  ...
}
</pre></div>
<p>is replaced by:</p>
<div class="source">
<pre>query {
  ...  
  allHumans(criteria: String): HumanConnection! @RelayConnection,
  ...
}
type HumanConnection {
        edges: [HumanEdge] 
        pageInfo: PageInfo! 
}

type HumanEdge {
        node: Human 
        cursor: String! 
}

type PageInfo {
        hasNextPage: Boolean! 
        hasPreviousPage: Boolean! 
        startCursor: String! 
        endCursor: String! 
}

interface Node {
        id: ID! 
}

# The Character interface is marked as implementing the Node interface
type Human implements Node { 
  ...
} 

</pre></div>
<p>And the field:</p>
<div class="source">
<pre>Human {
   ...
   friends: Character @RelayConnection,
   ...
}
</pre></div>
<p>is replaced by:</p>
<div class="source">
<pre>Human {
   ...
   friends: CharacterConnection! @RelayConnection,
   ...
}

interface CharacterConnection {
        edges: [CharacterEdge] 
        pageInfo: PageInfo! 
}

interface CharacterEdge {
        node: Character 
        cursor: String! 
}


type PageInfo {
        hasNextPage: Boolean! 
        hasPreviousPage: Boolean! 
        startCursor: String! 
        endCursor: String! 
}

interface Node {
        id: ID! 
}

# The Character interface is marked as implementing the Node interface
interface Character implements Node { 
  ...
} 
</pre></div>
<p>Please note that :</p>
<ul>
<li>This page is relevant only for the <b>server mode</b>. If you're generating a GraphQL server code, please check the <a href="./client_add_relay_connection.html">client Relay Connection page</a>.</li>
<li>The field's type marked with the <i>@RelayConnection</i> may be either a type or an interface. As it's a field's type, it may not be an input type.</li>
<li>The field's type marked with the <i>@RelayConnection</i> <b>MUST</b> contain an <i>id</i> field, of type ID. Otherwise, an error is thrown at code generation time.</li>
<li>If the <i>@RelayConnection</i> directive is set on a field of an interface, it will be applied to this interface's field, and to this field for all type that implements this interface. 
<ul>
<li>In this later case, the directive should also be set to this field, for all the implementing type. If not, a warning is generated.</li></ul></li>
<li>If the <i>@RelayConnection</i> is <i>B</i>not set<i>/B</i> on a field of an interface, but is set in the same field, for one type that implements this interface, then an error is generated. </li>
<li>For each type marked at least once, with the <i>@RelayConnection</i> directive (the <i>Human</i> type, and the <i>Character</i> interface, here above), the relevant XxxConnection and XxxEdge type ares added to the in-memory schema.</li>
<li>The <i>Node</i> interface is added as being implemented by each type marked at least once, with the <i>@RelayConnection</i> directive. For instance, in the two samples above, the <i>Human</i> type and the <i>Character</i> interface are marked as implementing the <i>Node</i> interface.</li>
<li>The relevant DataFetcherDelegate will be added. Please have look at the <a href="./server.html">server page</a> for more information on this. So your code has to implement:
<ul>
<li>The <i>DataFetchersDelegateNode</i> data fetcher delegate</li>
<li>The <i>DataFetchersDelegateXxxxConnection</i> data fetcher delegates, for each field's type or field's interface marked with the <i>@RelayConnection</i> directive</li>
<li>The <i>DataFetchersDelegateXxxxEdge</i> data fetcher delegates, for each field's type or field's interface marked with the <i>@RelayConnection</i> directive </li></ul></li></ul></section><section>
<h3><a name="Important_note_about_the_GraphQL_schema_.28only_when_in_server_mode.29"></a><a name="Important_note_about_the_GraphQL_schema_only_when_in_server_mode">Important note about the GraphQL schema (only when in server mode)</a></h3>
<p>The generated code is based on the graphql-java engine. This engine, when it starts the GraphQL server, needs to have access to the GraphQL schema. As the plugin updates the given GraphQL schema, based on the applied <i>@RelayConnection</i> directives, it also generates a GraphQL schema file.</p>
<p>This generated GraphQL schema file is named <i>generated_schema.graphqls</i>.</p>
<p>As a consequence, the provided must either have another name, or be stored in another place than the <i>src/main/resources</i> folder. To do this, you'll have to use the <i>schemaFileFolder</i> plugin parameter.</p></section><section>
<h3><a name="What_tasks_are_executed_by_the_plugin.3F"></a><a name="What_tasks_are_executed_by_the_plugin">What tasks are executed by the plugin?</a></h3>
<p>To sum-up, if <i>addRelayConnections</i> plugin parameter is set to true, the plugin will:</p>
<ul>
<li>Check that the <i>@RelayConnection</i> directive definition exists in the GraphQL schema, and is compliant with the above definition</li>
<li>Add the <i>Node</i> interface in the GraphQL schema (if not already defined).
<ul>
<li>If this interface is already defined in the given schema, but is not compliant with the relay specification, then an error is thrown.<i>/LI</i></li></ul></li>
<li>Add the <i>PageInfo</i> type in the GraphQL schema (if not already defined).
<ul>
<li>If this type is already defined in the given schema, but is not compliant with the relay specification, then an error is thrown.</li></ul></li>
<li>All the Edge and Connection type in the GraphQL schema, for each attribute's type that is marked by the <i>@RelayConnection</i> directive.</li></ul></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2021..      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
